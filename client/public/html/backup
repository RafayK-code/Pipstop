


const http = require('http');
const https = require('https'); 
const fs = require('fs');
const querystring = require('querystring'); // For parsing the incoming form data
const port = 3000;

// Infobip API details
const APIKey = 'Your_API_Key'; // Replace with your actual API key
const infobipAPIEndpoint = 'https://api.infobip.com/sms/1/text/single';

// Function to send SMS using Infobip
function sendSMS(message, phoneNumber) {
    const data = JSON.stringify({
        from: "YourSenderName", // Replace with your sender name
        to: phoneNumber,
        text: message
    });

    const options = {
        hostname: 'api.infobip.com',
        path: '/sms/1/text/single',
        method: 'POST',
        headers: {
            'Authorization': `App ${APIKey}`,
            'Content-Type': 'application/json',
            'Content-Length': data.length
        }
    };

    const req = https.request(options, (res) => {
        console.log(`statusCode: ${res.statusCode}`);

        res.on('data', (d) => {
            process.stdout.write(d);
        });
    });

    req.on('error', (error) => {
        console.error(error);
    });

    req.write(data);
    req.end();
}

const server = http.createServer(function(req, res) {
    if (req.method === 'POST' && req.url === '/send-sms') {
        let body = '';
        req.on('data', chunk => {
            body += chunk.toString();
        });
        req.on('end', () => {
            const parsedBody = querystring.parse(body);
            const phoneNumber = parsedBody.phoneNumber; // Assuming input name is 'phoneNumber'
            sendSMS('This is a test message from Infobip.', phoneNumber);
            res.writeHead(200, { 'Content-Type': 'text/html' });
            res.end('SMS sent successfully.');
        });
    } else {
        let filePath = 'index.html'; // Default file path
        let contentType = 'text/html'; // Default content type

        // Mapping URLs to file paths
        switch (req.url) {
            case '/style.css':
                filePath = 'style.css';
                contentType = 'text/css';
                break;
            case '/index':
                filePath = 'index.html';
                break;
            case '/health':
                filePath = 'health.html';
                break;
            case '/social':
                filePath = 'social.html';
                break;
            case '/funandgames':
                filePath = 'funandgames.html';
                break;
            case '/profile':
                filePath = 'profile.html';
                break;
            case '/leaderboard':
                filePath = 'leaderboard.html';
                break;
        }
    }
        
});

server.listen(port, function(error) {
    if (error) {
        console.log('Something went wrong', error);
    } else {
        console.log('Server is listening on port ' + port);
    }
});


